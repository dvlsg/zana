/*

    Copyright (C) 2014 Dave Lesage
    License: MIT
    See license.txt for full license text.
*/
function zUtil(a){this.setup(a)}
(function(a){function l(a,e){var f=c.getType(a),d=c.getType(e);return f===d&&(f===c.types.array||f===c.types.object)}var c=zUtil.prototype,g=function(){function a(b){this.xStack=[];this.yStack=[];this.count=0;this.maxStackDepth=b}a.prototype.push=function(a,b){this.xStack.push(a);this.yStack.push(b);this.count++};a.prototype.pop=function(){this.xStack.pop();this.yStack.pop();this.count--};return a}();c.getType=function(a){return Object.prototype.toString.call(a).match(/^\[object (.+)\]$/)[1]};c.deepCopy=
function(a){function e(a,b){d=h.xStack.indexOf(a);return-1===d?(h.push(a,b),c.forEach(a,function(a,e){b[e]=f(a)}),h.pop(),b):h.yStack[d]}function f(a){if(h.count>h.maxStackDepth)throw Error("Stack depth exceeded: "+h.stackMaxDepth+"!");switch(c.getType(a)){case c.types.object:return e(a,Object.create(a));case c.types.array:return e(a,[]);case c.types.regexp:return e(a,new RegExp(a));case c.types.date:return e(a,new Date(a.toString()));default:return a}}var d=-1,h=new g(1E3);return f(a)};c.defineProperty=
function(a,e,f){null==a[e]?Object.defineProperty(a,e,f):console.error("Error: the method "+e+" has already been defined on the following object: "+a)};c.equals=function(a,e){function f(a,b){if(a===b)return!0;var e=Object.keys(a),f=Object.keys(b);e.quicksort();f.quicksort();if(!d(e,f))return!1;h.push(a,b);for(var c in a)if(!d(a[c],b[c]))return!1;h.pop();return!0}function d(a,b){if(h.count>h.maxStackDepth)throw Error("Stack depth exceeded: "+h.maxStackDepth+"!");if(a===b)return!0;var e=c.getType(a),
g=c.getType(b);if(e!==g)return!1;var g=h.xStack.lastIndexOf(a),l=h.yStack.lastIndexOf(b);if(-1!==g&&-1!==l)return!0;switch(e){case c.types.date:if(a.getTime()!==b.getTime()||!f(a,b))return!1;break;case c.types["function"]:if(a.toString()!==b.toString())return!1;break;case c.types.array:if(a.length!==b.length)return!1;h.push(a,b);for(e=0;e<a.length;e++)if(!d(a[e],b[e]))return!1;h.pop();break;case c.types.object:case c.types.regexp:if(!f(a,b))return!1;break;default:if(a!==b)return!1}return!0}var h=
new g(1E3);return d(a,e)};c.sizeof=function(a){var e=[];a=[a];for(var f=0;a.length;){var d=a.pop();if("boolean"===typeof d)f+=4;else if("string"===typeof d)f+=2*d.length;else if("number"===typeof d)f+=8;else if("object"===typeof d&&-1===e.indexOf(d))for(i in e.push(d),d)a.push(d[i])}return f};c.forEach=function(a,e,f){switch(c.getType(a)){case c.types.object:case c.types.date:case c.types.regexp:case c.types["function"]:for(var d in a)a.hasOwnProperty(d)&&e.call(f,a[d],d);break;case c.types.array:for(d=
0;d<a.length;d++)e.call(f,a[d],d)}return a};c.smash=function(){var a=Array.prototype.slice.call(arguments);if(0>=a.length)return null;if(1===a.length)return a[0];var e=a[0],f=c.getType(a[0]);if(f=c.types["function"])f=c.types.object;var d=a[a.length-1];c.forEach(d,function(a,b){e[b]=c.deepCopy(d[b])});for(var h=a.length-2;1<=h;h--)c.assert(function(){return f===c.getType(a[h])}),c.forEach(a[h],function(f,d){c.check.exists(e[d])?l(e[d],a[h][d])&&(e[d]=c.smash(c.getType(a[h][d])===c.types.array?[]:
{},e[d],a[h][d])):e[d]=c.deepCopy(a[h][d])});return e};c.extend=function(){var a=Array.prototype.slice.call(arguments);if(0>=a.length)return null;if(1===a.length)return a[0];var e=a[0],f=c.getType(e);if(f=c.types["function"])f=c.types.object;for(var d=1;d<a.length;d++)c.assert(function(){return f===c.getType(a[d])}),c.forEach(a[d],function(f,g){c.check.exists(e[g])?l(e[g],a[d][g])&&(e[g]=c.smash(e[g],a[d][g])):e[g]=a[d][g]});return e};c.lambda=function(a){if(null==a)return c.functions.identity;if(c.getType(a)===
c.types["function"])return a;if(c.getType(a)===c.types.string){if(c.equals(a,""))return c.functions.identity;if(-1<a.indexOf("=>")){var e=a.match(c.functions.matcher);return(new Function(e[1]||[],"return "+e[2]+";")).bind(arguments.callee.caller)}}return function(e){return c.equals(a,e)}};c.setup=function(a){a=a||{};c.setup.initArrays(a.useArrayExtensions);c.setup.initNumbers(a.useNumberExtensions);c.setup.initObjects(a.useObjectExtensions);c.setup.initLogger(a.defaultLogger)};(function(){c.functions=
{identity:function(a){return a},"true":function(a){return!0},"false":function(a){return!1},empty:function(a){},matcher:/^(?:[(\s*]*)?(\w+(?:,\s*\w+)*)?(?:[)\s*]*)?=>(?:\s*)?(.*)$/};c.types={array:c.getType([]),"boolean":c.getType(!0),date:c.getType(new Date),"function":c.getType(function(){}),"null":c.getType(null),number:c.getType(0),object:c.getType({}),string:c.getType(""),regexp:c.getType(RegExp()),undefined:c.getType(a)}})()})();
(function(a,l){a.arrays={};a.arrays.aggregate=function(){var b=0,e=a.getType(this)===a.types.array?this:arguments[b++],f=arguments[b++],b=arguments[b++];a.assert.isNonEmptyArray(e);for(var f=a.lambda(f),b=null==b?e[0]:f(b,e[0]),d=1;d<e.length;d++)b=f(b,e[d]);return b};a.arrays.any=function(){var b=0,e=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++];if(null==b)return 0<e.length;for(var b=a.lambda(b),f=0;f<e.length;f++)if(b(e[f]))return!0;return!1};a.arrays.average=function(){var b=
0,e=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++];return a.arrays.sum(e,b)/e.length};a.arrays.contains=function(){var b=0,e=a.getType(this)===a.types.array?this:arguments[b++],f=arguments[b++],b=arguments[b++],d;d=a.check.isFunction(f)?function(a){return f(a)}:function(b,e){return a.equals(b,e)};if(null==b)for(var c=0;c<e.length;c++){if(d(e[c],f))return!0}else for(b=a.lambda(b),c=0;c<e.length;c++)if(d(b(e[c]),f))return!0;return!1};a.arrays.count=function(){var b=0,e=a.getType(this)===
a.types.array?this:arguments[b++],f=arguments[b++],b=arguments[b++],d=0,c;c=a.check.isFunction(f)?function(a){return f(a)}:function(b,e){return a.equals(b,e)};if(null==b)for(var g=0;g<e.length;g++)c(e[g],f)&&d++;else for(b=a.lambda(b),g=0;g<e.length;g++)c(b(e[g]),f)&&d++;return d};var c=function(){return a.deepCopy(this)};a.arrays.distinct=function(){var b=0,e=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],f=[];if(null==b)for(var d=0;d<e.length;d++)f.contains(e[d])||f.push(e[d]);
else for(b=a.lambda(b),d=0;d<e.length;d++)f.contains(b(e[d]),b)||f.push(e[d]);return f};var g=function(b){return a.equals(this,b)};a.arrays.first=function(){var b=0,e=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],e=this;if(null==b){if(0<e.length)return e[0]}else for(var b=a.lambda(b),f=0;f<e.length;f++)if(b(e[f]))return e[f];return null};a.arrays.innerJoin=function(){var b=0,e=a.getType(this)===a.types.array?this:arguments[b++],f=arguments[b++];return{on:function(b){var c=[];
b=a.lambda(b);for(var g=0;g<e.length;g++){a.check.isObject(e[g]);for(var m=0;m<f.length;m++)a.check.isObject(f[m]),b(e[g],f[m])&&c.push(a.smash({},e[g],f[m]))}return c}}};a.arrays.isEmpty=function(){var b=0,b=a.getType(this)===a.types.array?this:arguments[b++];if(1>b.length)return!0;for(var e=0;e<b.length;e++)if(a.check.exists(b[e]))return!1;return!0};a.arrays.isFull=function(){var b=0,b=a.getType(this)===a.types.array?this:arguments[b++];if(1>b.length)return!1;for(var e=0;e<b.length;e++)if(!a.check.exists(b[e]))return!1;
return!0};a.arrays.last=function(){var b=0,e=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++];if(null==b){if(0<e.length)return e[e.length-1]}else for(var b=a.lambda(b),f=e.length-1;0<=f;f--)if(b(e[f]))return e[f];return null};a.arrays.max=function(){var b=0,e=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],f=Number.MIN_VALUE;if(null!=b)for(var b=a.lambda(b),d=0;d<e.length;d++){var c=b(e[d]);a.check.isNumber(c)&&f<c&&(f=c)}else for(d=0;d<e.length;d++)c=e[d],
a.check.isNumber(c)&&f<c&&(f=c);return f};a.arrays.min=function(){var b=0,e=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],f=Number.MAX_VALUE;if(null!=b)for(var b=a.lambda(b),d=0;d<e.length;d++){var c=b(e[d]);a.check.isNumber(c)&&c<f&&(f=c)}else for(d=0;d<e.length;d++)c=e[d],a.check.isNumber(c)&&c<f&&(f=c);return f};a.arrays.orderBy=function(){var b=0,e=a.getType(this)===a.types.array?this:arguments[b++],c=arguments[b++],b=arguments[b++],c=a.lambda(c),b=b||function(a,b){return c(a)>
c(b)?1:c(a)<c(b)?-1:0},d=e.where(function(a){return null!=c(a)}),e=e.where(function(a){return null==c(a)});d.quicksort(b);return d.concat(e)};a.arrays.quicksort=function(){var b=0,e=a.getType(this)===a.types.array?this:arguments[b++],c=arguments[b++],c=a.getType(c)===a.types.string?a.lambda(c):c||function(a,b){return a>b?1:a<b?-1:0},d=function(a,b){do{var g=a,k=b,l=e[Math.floor((a+b)/2)];do{for(;g<e.length&&0>c(e[g],l);)g++;for(;0<=k&&0>c(l,e[k]);)k--;if(g>k)break;g<k&&e.swap(g,k);g++;k--}while(g<=
k);k-a<=b-g?(a<k&&d(a,k),a=g):(g<b&&d(g,b),b=k)}while(a<b)};d(0,this.length-1)};a.arrays.quicksort3=function(){var b=0,e=a.getType(this)===a.types.array?this:arguments[b++],c=arguments[b++],c=a.getType(c)===a.types.string?a.lambda(c):c||function(a,b){return a>b?1:a<b?-1:0},d=function(a,b){for(var g=a,k=b,l=e[a],p=a+1;p<=k;){var r=c(e[p],l);0>r?e.swap(g++,p++):0<r?e.swap(p,k--):p++}a<g-1&&d(a,g-1);k+1<b&&d(k+1,b)};d(0,this.length-1)};a.arrays.removeAll=function(){for(var b=0,c=a.getType(this)===a.types.array?
this:arguments[b++],b=arguments[b++],f=0,b=a.lambda(b),d=c.length-1;-1<d;d--)b(c[d])&&(c.splice(d,1),f++);return f};a.arrays.select=function(){for(var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],f=[],b=a.lambda(b),d=0;d<c.length;d++)f.push(b(c[d]));return f};a.arrays.skip=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],f=[];0>b&&(b=0);for(var d=0;d<c.length-b&&b<=c.length;d++)f[d]=c[d+b];return f};a.arrays.sum=function(){var b=
0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],f=0;if(null!=b)for(var b=a.lambda(b),d=0;d<c.length;d++){var g=b(c[d]);a.check.isNumber(g)&&(f+=g)}else for(d=0;d<c.length;d++)a.check.isNumber(c[d])&&(f+=c[d]);return f};a.arrays.swap=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],f=arguments[b++],b=arguments[b++],d=c[f];c[f]=c[b];c[b]=d};a.arrays.take=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],f=[];0>
b&&(b=0);for(var d=0;d<b&&d<c.length;d++)f[d]=c[d];return f};a.arrays.takeWhile=function(){for(var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],f=[],b=a.lambda(b),d=0;d<count&&b(c[d]);d++)f.push(c[d]);return f};a.arrays.where=function(){for(var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],b=a.lambda(b),c=this,f=[],d=0;d<c.length;d++)b(c[d])&&f.push(c[d]);return f};a.arrays.zip=function(){for(var b=0,c=a.getType(this)===a.types.array?this:
arguments[b++],f=arguments[b++],b=arguments[b++],b=a.lambda(b),d=[],g=0;g<this.length;g++)d.push(b(c[g],f[g]));return d};a.setup.initArrays=function(b){b&&(a.defineProperty(Array.prototype,"aggregate",{enumerable:!1,writable:!1,value:a.arrays.aggregate}),a.defineProperty(Array.prototype,"any",{enumerable:!1,writable:!1,value:a.arrays.any}),a.defineProperty(Array.prototype,"average",{enumerable:!1,writable:!1,value:a.arrays.average}),a.defineProperty(Array.prototype,"contains",{enumerable:!1,writable:!1,
value:a.arrays.contains}),a.defineProperty(Array.prototype,"count",{enumerable:!1,writable:!1,value:a.arrays.count}),a.defineProperty(Array.prototype,"deepCopy",{enumerable:!1,writable:!1,value:c}),a.defineProperty(Array.prototype,"distinct",{enumerable:!1,writable:!1,value:a.arrays.distinct}),a.defineProperty(Array.prototype,"equals",{enumerable:!1,writable:!1,value:g}),a.defineProperty(Array.prototype,"first",{enumerable:!1,writable:!1,value:a.arrays.first}),a.defineProperty(Array.prototype,"innerJoin",
{enumerable:!1,writable:!1,value:a.arrays.innerJoin}),a.defineProperty(Array.prototype,"isEmpty",{enumerable:!1,writable:!1,value:a.arrays.isEmpty}),a.defineProperty(Array.prototype,"isFull",{enumerable:!1,writable:!1,value:a.arrays.isFull}),a.defineProperty(Array.prototype,"last",{enumerable:!1,writable:!1,value:a.arrays.last}),a.defineProperty(Array.prototype,"max",{enumerable:!1,writable:!1,value:a.arrays.max}),a.defineProperty(Array.prototype,"min",{enumerable:!1,writable:!1,value:a.arrays.min}),
a.defineProperty(Array.prototype,"orderBy",{enumerable:!1,writable:!1,value:a.arrays.orderBy}),a.defineProperty(Array.prototype,"quicksort",{enumerable:!1,writable:!1,value:a.arrays.quicksort}),a.defineProperty(Array.prototype,"quicksort3",{enumerable:!1,writable:!1,value:a.arrays.quicksort3}),a.defineProperty(Array.prototype,"removeAll",{enumerable:!1,writable:!1,value:a.arrays.removeAll}),a.defineProperty(Array.prototype,"select",{enumerable:!1,writable:!1,value:a.arrays.select}),a.defineProperty(Array.prototype,
"skip",{enumerable:!1,writable:!1,value:a.arrays.skip}),a.defineProperty(Array.prototype,"sum",{enumerable:!1,writable:!1,value:a.arrays.sum}),a.defineProperty(Array.prototype,"swap",{enumerable:!1,writable:!1,value:a.arrays.swap}),a.defineProperty(Array.prototype,"take",{enumerable:!1,writable:!1,value:a.arrays.take}),a.defineProperty(Array.prototype,"takeWhile",{enumerable:!1,writable:!1,value:a.arrays.takeWhile}),a.defineProperty(Array.prototype,"where",{enumerable:!1,writable:!1,value:a.arrays.where}),
a.defineProperty(Array.prototype,"zip",{enumerable:!1,writable:!1,value:a.arrays.zip}))}})(zUtil.prototype);
(function(a,l){a.classes=a.classes||{};var c=function(b,c){var d=arguments.callee.caller;if(a.getType(b)===a.types["function"]){if(!b()){if(c)throw Error(c);d=b.toString();d=d.substring(d.indexOf("{")+1,d.lastIndexOf("}")).trim();throw Error("Assertion failed: "+d);}}else if(a.getType(b)===a.types.string){if(b=a.lambda(b).bind(d),!b()){if(c)throw Error(c);d=b.toString();d=d.substring(d.indexOf("{")+1,d.lastIndexOf("}")).trim();throw Error("Assertion failed: "+d);}}else if(!b){if(c)throw Error(c);
throw Error("Assertion failed: "+String(b));}},g=function(){c(function(){return a.check.argsNotNull.apply(this,arguments)})},b=function(b){c(function(){return a.check.exists(b)})},e=function(b){c(function(){return a.check.isArray(b)})},f=function(b){c(function(){return a.check.isBoolean(b)})},d=function(b){c(function(){return a.check.isFunction(b)})},h=function(b){c(function(){return a.check.isNonEmptyArray(b)})},n=function(b){c(function(){return a.check.isNumber(b)})},m=function(b){c(function(){return a.check.isObject(b)})},
k=function(b){c(function(){return a.check.isReference(b)})},q=function(b){c(function(){return a.check.isString(b)})},p=function(b,d){c(function(){return a.check.isType(b,d)})},r=function(b){c(function(){return a.check.isValue(b)})},s=function(){return function(){return function(c){a.defineProperty(c,"argsNotNull",{get:function(){return g},writeable:!1});a.defineProperty(c,"exists",{get:function(){return b},writeable:!1});a.defineProperty(c,"isArray",{get:function(){return e},writeable:!1});a.defineProperty(c,
"isBoolean",{get:function(){return f},writeable:!1});a.defineProperty(c,"isFunction",{get:function(){return d},writeable:!1});a.defineProperty(c,"isNonEmptyArray",{get:function(){return h},writeable:!1});a.defineProperty(c,"isNumber",{get:function(){return n},writeable:!1});a.defineProperty(c,"isObject",{get:function(){return m},writeable:!1});a.defineProperty(c,"isReference",{get:function(){return k},writeable:!1});a.defineProperty(c,"isString",{get:function(){return q},writeable:!1});a.defineProperty(c,
"isType",{get:function(){return p},writeable:!1});a.defineProperty(c,"isValue",{get:function(){return r},writeable:!1});return c}(c)}}();a.classes.Asserter=s;a.assert=new a.classes.Asserter})(zUtil.prototype);
(function(a,l){var c=function(){};c.argsNotNull=function(){for(var a=0;a<arguments.length;a++)if(null==arguments[a])return!1;return!0};c.exists=function(a){return null!=a};c.isArray=function(c){return a.getType(c)===a.types.array};c.isBoolean=function(c){return a.getType(c)===a.types["boolean"]};c.isFunction=function(c){return a.getType(c)===a.types["function"]};c.isNonEmptyArray=function(c){return null!=c&&a.getType(c)===a.types.array&&0<c.length};c.isNumber=function(a){return!isNaN(a)};c.isObject=
function(c){return a.getType(c)===a.types.object};c.isReference=function(c){switch(a.getType(c)){case a.types.object:case a.types.array:case a.types.date:case a.types.regexp:case a.types["function"]:return!0;default:return!1}};c.isString=function(c){return a.getType(c)===a.types.string};c.isType=function(c,b){return a.getType(c)===b};c.isValue=function(c){switch(a.getType(c)){case a.types.string:case a.types["boolean"]:case a.types.number:case a.types["null"]:case a.types.undefined:return!0;default:return!1}};
a.check=c})(zUtil.prototype);
(function(a,l){a.classes=a.classes||{};var c=function(c,d){a.assert.isString(d);switch(d){case a.types["boolean"]:return g(c);case a.types.number:return b(c)}},g=function(b){if(b&&a.check.isFunction(b.toBoolean))return b.toBoolean();switch(a.getType(b)){case a.types["boolean"]:return b;case a.types.string:switch(b.toLowerCase().trim()){case "false":case "0":case "":case null:case l:return!1;default:return!0}default:return!!b}},b=function(b){if(b&&a.check.isFunction(b.toNumber))return b.toNumber();switch(a.getType(b)){case a.types.number:return b;
default:return+b}},e=function(){return function(){return function(c){a.defineProperty(c,"toBoolean",{get:function(){return g},writeable:!1});a.defineProperty(c,"toNumber",{get:function(){return b},writeable:!1});return c}(c)}}();a.classes.Converter=e;a.convert=new a.classes.Converter})(zUtil.prototype);
(function(a,l){var c={},g;c.build=function(b){a.check.isObject(b);a.check.isArray(b.Tables);b=b.Tables.orderBy("x => x.TableName");for(var e=0;e<b.length;e++)c.makeTable(b[e])};c.makeTable=function(b){a.check.isObject(b);a.check.isString(b.TableName);a.check.isArray(b.PrimaryKeys);a.check.isArray(b.ForeignKeys);var e=[],f=[],d=[],h=[];switch(g){case "sqlite":e.push("CREATE TABLE IF NOT EXISTS "+b.TableName+" (");for(var n=0;n<b.Columns.length;n++){var m=b.Columns[n],k=c.types[m.DataType][g],k=k.length?
k.type+"("+k.length+")":k.type;0===n?f.push("    "+m.ColumnName+" "+k+(m.IsNullable?"":" NOT NULL")):f.push(m.ColumnName+" "+k+(m.IsNullable?"":" NOT NULL"))}f=f.join("\n    , ");e.push(f);h.push("    , PRIMARY KEY (");for(n=0;n<b.PrimaryKeys.length;n++)d.push(b.PrimaryKeys[n].ColumnName);h.push(d.join(", "));h.push(")");b=h.join("");e.push(b);e.push(")");e.join("\n")}};c.load=function(b,c,f){a.check.isString(b);a.check.isString(c);a.check.isNumber(f);g=c.toLowerCase();switch(g){case "sqlite":openDatabase(b,
"0.1",b,f)}};c.types={bit:{sqlite:{type:"INTEGER"}},"char":{sqlite:{type:"TEXT"}},datetime:{sqlite:{type:"TEXT"}},datetime2:{sqlite:{type:"TEXT"}},decimal:{sqlite:{type:"REAL"}},"float":{sqlite:{type:"REAL"}},"int":{sqlite:{type:"INTEGER"}},money:{sqlite:{type:"REAL"}},nvarchar:{sqlite:{type:"TEXT"}},smallint:{sqlite:{type:"INTEGER"}},smallmoney:{sqlite:{type:"REAL"}},text:{sqlite:{type:"TEXT"}},tinyint:{sqlite:{type:"INTEGER"}},varchar:{sqlite:{type:"TEXT"}},uniqueidentifier:{sqlite:{type:"CHAR",
length:36},mssql:{type:"uniqueidentifier"}}};a.db=c})(zUtil.prototype);
(function(a,l){a.classes=a.classes||{};var c=function(){return function(){var c=[],b=function(a){var b=c[a];if(null!=b)for(var e=0;e<b.length;e++){var f=b[e];null!=f.func&&f.func.apply(null,Array.prototype.slice.call(arguments,1))}},e=function(b){a.check.exists(b);c[b]=null},f=function(b,e){a.check.exists(b);a.check.isFunction(e);var f=c[b]||(c[b]=[]),m={func:e};f.push(m);return function(){c[b].removeAll(function(a){return a===m})}};return function(c){a.defineProperty(c,"call",{get:function(){return b},
writeable:!1});a.defineProperty(c,"clear",{get:function(){return e},writeable:!1});a.defineProperty(c,"on",{get:function(){return f},writeable:!1});return c}({})}}();a.classes.Events=c;a.events=new a.classes.Events})(zUtil.prototype);
(function(a,l){var c=/\+/g,g=function(b){a.defineProperty(b,"parameters",{get:function(){var a={},b=window.location.href,d=b.indexOf("?");if(-1<d)for(b=b.substring(d+1).split("&"),d=0;d<b.length;d++){var g=b[d].split("=");2==g.length&&(a[g[0]]=decodeURIComponent(g[1].replace(c," ")))}return a},writeable:!1});a.defineProperty(b,"locale",{get:function(){return this.parameters.locale||navigator.language||navigator.userLanguage},writeable:!1});return b}({});a.location=g})(zUtil.prototype);
(function(a,l){a.classes=a.classes||{};var c=["log"],g=function(){return function(b,e){var f,d,g,n,m,k,q=function(b){if(a.getType(b)===a.types.string)a:switch(b.toLowerCase().trim()){case "false":case "0":case "":case null:case l:b=!1;break a;default:b=!0}f=!!b},p;(p=function(b){a.assert.exists(b);for(var f=0;f<c.length;f++)a.assert.isFunction(b[c[f]]);d=b.log.bind(b);g=a.check.exists(b.debug)?b.debug.bind(b):b.log.bind(b);n=a.check.exists(b.error)?b.error.bind(b):b.log.bind(b);m=a.check.exists(b.info)?
b.info.bind(b):b.log.bind(b);k=a.check.exists(b.warn)?b.warn.bind(b):b.log.bind(b);q(null!=e?e:a.location?a.location.parameters.debug:!1)})(b);return function(b){a.defineProperty(b,"debug",{get:function(){return f?g:a.functions.empty},writeable:!1});a.defineProperty(b,"error",{get:function(){return n},writeable:!1});a.defineProperty(b,"info",{get:function(){return m},writeable:!1});a.defineProperty(b,"log",{get:function(){return d},writeable:!1});a.defineProperty(b,"warn",{get:function(){return k},
writeable:!1});a.defineProperty(b,"setDebugLogging",{get:function(){return q},writeable:!1});a.defineProperty(b,"setLogger",{get:function(){return p},writeable:!1});return b}(d)}}();a.setup.initLogger=function(b){a.check.exists(b)&&(a.log=new a.classes.LogInterface(b))};a.classes.LogInterface=g})(zUtil.prototype);
(function(a,l){a.match=function(c,g){var b=[];if(!g||a.getType(g)!==a.types.object||!c||a.getType(c)!==a.types.array||1>c.length)return b;var e=Object.keys(g).length;if(1>e)return b;for(var f,d=0;d<c.length;d++){f=0;for(var h in g){var l;l=c[d][h];var m=g[h];if(a.getType(l)===a.types.array){a.getType(m)!==a.types.array&&(m=[m]);b:{for(var k=0;k<m.length;k++)if(!l.contains(m[k])){l=!1;break b}l=!0}}else l=l===m;l&&f++}f===e&&b.push(c[d])}return b}})(zUtil.prototype);
(function(a,l){a.numbers={};a.numbers.factors=function(){var c=0,c=a.getType(this)===a.types.number?this:arguments[c++];a.assert.isNumber(c);for(var g=[],b=[],e=1;e<=Math.floor(Math.sqrt(c));e++)0==c%e&&(g.push(e),c/e!==e&&b.push(c/e));return g.concat(b.reverse())};a.numbers.round=function(){var c=0,g=a.getType(this)===a.types.number?this:arguments[c++],b=arguments[c++]||1,c=arguments[c++];a.assert.isNumber(g);if(c){c=c.toString().toLowerCase();if("down"===c)return a.numbers.roundDown(g,b);if("up"===
c)return a.numbers.roundUp(g,b)}return Math.round(g/b)*b};a.numbers.roundDown=function(){var c=0,g=a.getType(this)===a.types.number?this:arguments[c++],c=arguments[c++]||1;a.assert.isNumber(g);return Math.floor(g/c)*c};a.numbers.roundUp=function(){var c=0,g=a.getType(this)===a.types.number?this:arguments[c++],c=arguments[c++]||1;a.assert.isNumber(g);return Math.ceil(g/c)*c};a.setup.initNumbers=function(c){c&&(a.defineProperty(Number.prototype,"factors",{enumerable:!1,writable:!1,value:a.numbers.factors}),
a.defineProperty(Number.prototype,"round",{enumerable:!1,writable:!1,value:a.numbers.round}),a.defineProperty(Number.prototype,"roundDown",{enumerable:!1,writable:!1,value:a.numbers.roundDown}),a.defineProperty(Number.prototype,"roundUp",{enumerable:!1,writable:!1,value:a.numbers.roundUp}))}})(zUtil.prototype);
(function(a,l){a.objects={};var c=function(){return a.deepCopy(this)},g=function(b,c){return a.defineProperty(this,b,c)},b=function(b){return a.equals(this,b)},e=function(){var b=Array.prototype.slice.call(arguments);b.unshift(this);return a.objects.extend.apply(null,b)};a.objects.extend=function(){return a.extend.apply(null,arguments)};var f=function(){var b=Array.prototype.slice.call(arguments);b.unshift(this);return a.objects.smash.apply(null,b)};a.objects.smash=function(){return a.smash.apply(null,
arguments)};a.setup.initObjects=function(d){d&&(a.defineProperty(Object.prototype,"deepCopy",{enumerable:!1,writable:!1,value:c}),a.defineProperty(Object.prototype,"defineProperty",{enumerable:!1,writable:!1,value:g}),a.defineProperty(Object.prototype,"equals",{enumerable:!1,writable:!1,value:b}),a.defineProperty(Object.prototype,"extend",{enumerable:!1,writable:!1,value:e}),a.defineProperty(Object.prototype,"smash",{enumerable:!1,writable:!1,value:f}))}})(zUtil.prototype);
(function(a,l){function c(b){var c=new g,d=b||"";this.stop=function(){c.stop();a.log.debug(d+" took: "+c.duration()+" ms")};c.start()}function g(){var a=null,b=null,c=!1;this.start=function(){c||(b=null,c=!0,a=(new Date).getTime())};this.stop=function(){c&&(b=(new Date).getTime(),c=!1)};this.duration=function(){return c?(new Date).getTime()-a:b-a};this.reset=function(){c=!1;b=a=null}}a.classes=a.classes||{};var b=function(){return function(){var b=[],f=function(a){b.push(new c(a))},d=function(){0<
b.length&&b.pop().stop()};return function(b){a.defineProperty(b,"push",{get:function(){return f},writeable:!1});a.defineProperty(b,"pop",{get:function(){return d},writeable:!1});return b}({})}}();a.classes.StopwatchStack=b;a.classes.StopwatchWrapper=c;a.classes.Stopwatch=g;a.sw=new a.classes.StopwatchStack})(zUtil.prototype);
