/*

    Copyright (C) 2014 Dave Lesage
    License: MIT
    See license.txt for full license text.
*/
function zUtil(a){this.setup(a)}
(function(a){var g=zUtil.prototype,d=function(){function a(b){this.xStack=[];this.yStack=[];this.count=0;this.maxStackDepth=b}a.prototype.push=function(a,c){this.xStack.push(a);this.yStack.push(c);this.count++};a.prototype.pop=function(){this.xStack.pop();this.yStack.pop();this.count--};return a}();g.getType=function(a){return Object.prototype.toString.call(a).match(/^\[object (.+)\]$/)[1]};g.deepCopy=function(a){function b(a,b){f=k.xStack.indexOf(a);return-1===f?(k.push(a,b),g.forEach(a,function(a,
f){b[f]=e(a)}),k.pop(),b):k.yStack[f]}function c(a){var f=a.toString(),c=f.substring(f.indexOf("(")+1,f.indexOf(")")).trim().split(",");c.map(function(a,b,f){f[b]=a.trim()});f=f.substring(f.indexOf("{")+1,f.indexOf("}")).trim();c=new Function(c,f);return b(a,c)}function e(a){if(k.count>k.maxStackDepth)throw Error("Stack depth exceeded: "+k.stackMaxDepth+"!");switch(g.getType(a)){case g.types.object:return b(a,Object.create(a));case g.types.array:return b(a,[]);case g.types.regexp:return b(a,new RegExp(a));
case g.types.date:return b(a,new Date(a.toString()));case g.types.function:return c(a);default:return a}}var f=-1,k=new d(1E3);return e(a)};g.defineProperty=function(a,b,c){null==a[b]?Object.defineProperty(a,b,c):console.error("Error: the method "+b+" has already been defined on the following object: "+a)};g.equals=function(a,b){function c(a,b){if(a===b)return!0;var c=Object.keys(a),h=Object.keys(b);c.quicksort();h.quicksort();if(!e(c,h))return!1;f.push(a,b);for(var d in a)if(!e(a[d],b[d]))return!1;
f.pop();return!0}function e(a,b){if(f.count>f.maxStackDepth)throw Error("Stack depth exceeded: "+f.maxStackDepth+"!");if(a===b)return!0;var h=g.getType(a),d=g.getType(b);if(h!==d)return!1;var d=f.xStack.lastIndexOf(a),q=f.yStack.lastIndexOf(b);if(-1!==d&&-1!==q)return!0;switch(h){case g.types.date:if(a.getTime()!==b.getTime()||!c(a,b))return!1;break;case g.types.function:if(!g.equals(g.functions.getBody(a),g.functions.getBody(b))||!g.equals(g.functions.getArgumentNames(a),g.functions.getArgumentNames(b))||
!c(a,b))return!1;break;case g.types.array:if(a.length!==b.length)return!1;f.push(a,b);for(h=0;h<a.length;h++)if(!e(a[h],b[h]))return!1;f.pop();break;case g.types.object:case g.types.regexp:if(!c(a,b))return!1;break;default:if(a!==b)return!1}return!0}var f=new d(1E3);return e(a,b)};g.extend=function(){var a=Array.prototype.slice.call(arguments);if(0>=a.length)return null;if(1===a.length)return a[0];for(var b=a[0],c=1;c<a.length;c++)g.assert.isSmashable(b,a[c]),g.forEach(a[c],function(e,f){g.check.exists(b[f])?
g.check.isSmashable(b[f],a[c][f])&&(b[f]=g.smash(b[f],a[c][f])):b[f]=a[c][f]});return b};g.forEach=function(a,b,c){switch(g.getType(a)){case g.types.object:case g.types.date:case g.types.regexp:case g.types.function:for(var e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e);break;case g.types.array:for(e=0;e<a.length;e++)b.call(c,a[e],e)}return a};g.sizeof=function(a){var b=[];a=[a];for(var c=0;a.length;){var e=a.pop();if("boolean"===typeof e)c+=4;else if("string"===typeof e)c+=2*e.length;else if("number"===
typeof e)c+=8;else if("object"===typeof e&&-1===b.indexOf(e))for(i in b.push(e),e)a.push(e[i])}return c};g.smash=function(){var a=Array.prototype.slice.call(arguments);if(0>=a.length)return null;if(1===a.length)return a[0];var b=a[0],c=a[a.length-1];g.assert.isSmashable(b,c);g.forEach(c,function(a,e){g.check.isSmashable(b[e],c[e])?g.smash(b[e],c[e]):b[e]=g.deepCopy(c[e])});for(var e=a.length-2;1<=e;e--)g.assert.isSmashable(a[e],b),g.forEach(a[e],function(f,c){g.check.exists(b[c])?g.check.isSmashable(b[c],
a[e][c])&&g.smash(b[c],a[e][c]):b[c]=g.deepCopy(a[e][c])});return b};g.lambda=function(a){if(null==a)return g.functions.identity;if(g.getType(a)===g.types.function)return a;if(g.getType(a)===g.types.string){if(g.equals(a,""))return g.functions.identity;if(-1<a.indexOf("=>")){var b=a.match(g.functions.matcher);return(new Function(b[1]||[],"return "+b[2]+";")).bind(arguments.callee.caller)}}return function(b){return g.equals(a,b)}};g.setup=function(a){a=a||{};g.setup.initArrays(a.useArrayExtensions);
g.setup.initFunctions(a.useFunctionExtensions);g.setup.initNumbers(a.useNumberExtensions);g.setup.initObjects(a.useObjectExtensions);g.setup.initLogger(a.defaultLogger)};(function(){g.functions={identity:function(a){return a},"true":function(a){return!0},"false":function(a){return!1},empty:function(a){},matcher:/^(?:[(\s*]*)?(\w+(?:,\s*\w+)*)?(?:[)\s*]*)?=>(?:\s*)?(.*)$/};g.types={array:g.getType([]),"boolean":g.getType(!0),date:g.getType(new Date),"function":g.getType(function(){}),"null":g.getType(null),
number:g.getType(0),object:g.getType({}),string:g.getType(""),regexp:g.getType(RegExp()),undefined:g.getType(a)}})()})();
(function(a,g){a.arrays={};a.arrays.aggregate=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],e=arguments[b++],b=arguments[b++];a.assert.isNonEmptyArray(c);for(var e=a.lambda(e),b=null==b?c[0]:e(b,c[0]),f=1;f<c.length;f++)b=e(b,c[f]);return b};a.arrays.any=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++];if(null==b)return 0<c.length;for(var b=a.lambda(b),e=0;e<c.length;e++)if(b(c[e]))return!0;return!1};a.arrays.average=function(){var b=
0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++];return a.arrays.sum(c,b)/c.length};a.arrays.contains=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],e=arguments[b++],b=arguments[b++],f;f=a.check.isFunction(e)?function(a){return e(a)}:function(b,f){return a.equals(b,f)};if(null==b)for(var k=0;k<c.length;k++){if(f(c[k],e))return!0}else for(b=a.lambda(b),k=0;k<c.length;k++)if(f(b(c[k]),e))return!0;return!1};a.arrays.count=function(){var b=0,c=a.getType(this)===
a.types.array?this:arguments[b++],e=arguments[b++],b=arguments[b++],f=0,k;k=a.check.isFunction(e)?function(a){return e(a)}:function(b,f){return a.equals(b,f)};if(null==b)for(var d=0;d<c.length;d++)k(c[d],e)&&f++;else for(b=a.lambda(b),d=0;d<c.length;d++)k(b(c[d]),e)&&f++;return f};var d=function(){return a.deepCopy(this)};a.arrays.distinct=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],e=[];if(null==b)for(var f=0;f<c.length;f++)e.contains(c[f])||e.push(c[f]);
else for(b=a.lambda(b),f=0;f<c.length;f++)e.contains(b(c[f]),b)||e.push(c[f]);return e};var h=function(b){return a.equals(this,b)};a.arrays.first=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],c=this;if(null==b){if(0<c.length)return c[0]}else for(var b=a.lambda(b),e=0;e<c.length;e++)if(b(c[e]))return c[e];return null};a.arrays.innerJoin=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],e=arguments[b++];return{on:function(b){var d=[];
b=a.lambda(b);for(var h=0;h<c.length;h++){a.check.isObject(c[h]);for(var g=0;g<e.length;g++)a.check.isObject(e[g]),b(c[h],e[g])&&d.push(a.smash({},c[h],e[g]))}return d}}};a.arrays.isEmpty=function(){var b=0,b=a.getType(this)===a.types.array?this:arguments[b++];if(1>b.length)return!0;for(var c=0;c<b.length;c++)if(a.check.exists(b[c]))return!1;return!0};a.arrays.isFull=function(){var b=0,b=a.getType(this)===a.types.array?this:arguments[b++];if(1>b.length)return!1;for(var c=0;c<b.length;c++)if(!a.check.exists(b[c]))return!1;
return!0};a.arrays.last=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++];if(null==b){if(0<c.length)return c[c.length-1]}else for(var b=a.lambda(b),e=c.length-1;0<=e;e--)if(b(c[e]))return c[e];return null};a.arrays.max=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],e=Number.MIN_VALUE;if(null!=b)for(var b=a.lambda(b),f=0;f<c.length;f++){var d=b(c[f]);a.check.isNumber(d)&&e<d&&(e=d)}else for(f=0;f<c.length;f++)d=c[f],
a.check.isNumber(d)&&e<d&&(e=d);return e};a.arrays.min=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],e=Number.MAX_VALUE;if(null!=b)for(var b=a.lambda(b),f=0;f<c.length;f++){var d=b(c[f]);a.check.isNumber(d)&&d<e&&(e=d)}else for(f=0;f<c.length;f++)d=c[f],a.check.isNumber(d)&&d<e&&(e=d);return e};a.arrays.mutate=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],e=arguments[b++],e=a.lambda(e);a.check.isFunction(e)&&a.forEach(c,function(a,
b){c[b]=e(c[b])});return c};a.arrays.orderBy=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],e=arguments[b++],b=arguments[b++],e=a.lambda(e),b=b||function(a,b){return e(a)>e(b)?1:e(a)<e(b)?-1:0},f=c.where(function(a){return null!=e(a)}),c=c.where(function(a){return null==e(a)});f.quicksort(b);return f.concat(c)};a.arrays.quicksort=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],e=arguments[b++],e=a.getType(e)===a.types.string?a.lambda(e):e||function(a,
b){return a>b?1:a<b?-1:0},f=function(a,b){do{var d=a,h=b,g=c[Math.floor((a+b)/2)];do{for(;d<c.length&&0>e(c[d],g);)d++;for(;0<=h&&0>e(g,c[h]);)h--;if(d>h)break;d<h&&c.swap(d,h);d++;h--}while(d<=h);h-a<=b-d?(a<h&&f(a,h),a=d):(d<b&&f(d,b),b=h)}while(a<b)};f(0,this.length-1)};a.arrays.quicksort3=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],e=arguments[b++],e=a.getType(e)===a.types.string?a.lambda(e):e||function(a,b){return a>b?1:a<b?-1:0},f=function(a,b){for(var d=a,h=b,g=
c[a],p=a+1;p<=h;){var r=e(c[p],g);0>r?c.swap(d++,p++):0<r?c.swap(p,h--):p++}a<d-1&&f(a,d-1);h+1<b&&f(h+1,b)};f(0,this.length-1)};a.arrays.removeAll=function(){for(var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],e=0,b=a.lambda(b),f=c.length-1;-1<f;f--)b(c[f])&&(c.splice(f,1),e++);return e};a.arrays.select=function(){for(var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],e=[],b=a.lambda(b),f=0;f<c.length;f++)e.push(b(c[f]));return e};a.arrays.skip=
function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],e=[];0>b&&(b=0);for(var f=0;f<c.length-b&&b<=c.length;f++)e[f]=c[f+b];return e};a.arrays.sum=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],e=0;if(null!=b)for(var b=a.lambda(b),f=0;f<c.length;f++){var d=b(c[f]);a.check.isNumber(d)&&(e+=d)}else for(f=0;f<c.length;f++)a.check.isNumber(c[f])&&(e+=c[f]);return e};a.arrays.swap=function(){var b=0,c=a.getType(this)===a.types.array?
this:arguments[b++],e=arguments[b++],b=arguments[b++],f=c[e];c[e]=c[b];c[b]=f};a.arrays.take=function(){var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],e=[];0>b&&(b=0);for(var f=0;f<b&&f<c.length;f++)e[f]=c[f];return e};a.arrays.takeWhile=function(){for(var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],b=arguments[b++],e=[],b=a.lambda(b),f=0;f<count&&b(c[f]);f++)e.push(c[f]);return e};a.arrays.where=function(){for(var b=0,c=a.getType(this)===a.types.array?
this:arguments[b++],b=arguments[b++],b=a.lambda(b),c=this,e=[],f=0;f<c.length;f++)b(c[f])&&e.push(c[f]);return e};a.arrays.zip=function(){for(var b=0,c=a.getType(this)===a.types.array?this:arguments[b++],e=arguments[b++],b=arguments[b++],b=a.lambda(b),f=[],d=0;d<this.length;d++)f.push(b(c[d],e[d]));return f};a.setup.initArrays=function(b){b&&(a.defineProperty(Array.prototype,"aggregate",{enumerable:!1,writable:!1,value:a.arrays.aggregate}),a.defineProperty(Array.prototype,"any",{enumerable:!1,writable:!1,
value:a.arrays.any}),a.defineProperty(Array.prototype,"average",{enumerable:!1,writable:!1,value:a.arrays.average}),a.defineProperty(Array.prototype,"contains",{enumerable:!1,writable:!1,value:a.arrays.contains}),a.defineProperty(Array.prototype,"count",{enumerable:!1,writable:!1,value:a.arrays.count}),a.defineProperty(Array.prototype,"deepCopy",{enumerable:!1,writable:!1,value:d}),a.defineProperty(Array.prototype,"distinct",{enumerable:!1,writable:!1,value:a.arrays.distinct}),a.defineProperty(Array.prototype,
"equals",{enumerable:!1,writable:!1,value:h}),a.defineProperty(Array.prototype,"first",{enumerable:!1,writable:!1,value:a.arrays.first}),a.defineProperty(Array.prototype,"innerJoin",{enumerable:!1,writable:!1,value:a.arrays.innerJoin}),a.defineProperty(Array.prototype,"isEmpty",{enumerable:!1,writable:!1,value:a.arrays.isEmpty}),a.defineProperty(Array.prototype,"isFull",{enumerable:!1,writable:!1,value:a.arrays.isFull}),a.defineProperty(Array.prototype,"last",{enumerable:!1,writable:!1,value:a.arrays.last}),
a.defineProperty(Array.prototype,"max",{enumerable:!1,writable:!1,value:a.arrays.max}),a.defineProperty(Array.prototype,"min",{enumerable:!1,writable:!1,value:a.arrays.min}),a.defineProperty(Array.prototype,"mutate",{enumerable:!1,writable:!1,value:a.arrays.mutate}),a.defineProperty(Array.prototype,"orderBy",{enumerable:!1,writable:!1,value:a.arrays.orderBy}),a.defineProperty(Array.prototype,"quicksort",{enumerable:!1,writable:!1,value:a.arrays.quicksort}),a.defineProperty(Array.prototype,"quicksort3",
{enumerable:!1,writable:!1,value:a.arrays.quicksort3}),a.defineProperty(Array.prototype,"removeAll",{enumerable:!1,writable:!1,value:a.arrays.removeAll}),a.defineProperty(Array.prototype,"select",{enumerable:!1,writable:!1,value:a.arrays.select}),a.defineProperty(Array.prototype,"skip",{enumerable:!1,writable:!1,value:a.arrays.skip}),a.defineProperty(Array.prototype,"sum",{enumerable:!1,writable:!1,value:a.arrays.sum}),a.defineProperty(Array.prototype,"swap",{enumerable:!1,writable:!1,value:a.arrays.swap}),
a.defineProperty(Array.prototype,"take",{enumerable:!1,writable:!1,value:a.arrays.take}),a.defineProperty(Array.prototype,"takeWhile",{enumerable:!1,writable:!1,value:a.arrays.takeWhile}),a.defineProperty(Array.prototype,"where",{enumerable:!1,writable:!1,value:a.arrays.where}),a.defineProperty(Array.prototype,"zip",{enumerable:!1,writable:!1,value:a.arrays.zip}))}})(zUtil.prototype);
(function(a,g){a.classes=a.classes||{};var d=function(b,f){var c=arguments.callee.caller;if(a.getType(b)===a.types.function){if(!b()){if(f)throw Error(f);c=b.toString();c=c.substring(c.indexOf("{")+1,c.lastIndexOf("}")).trim();throw Error("Assertion failed: "+c);}}else if(a.getType(b)===a.types.string){if(b=a.lambda(b).bind(c),!b()){if(f)throw Error(f);c=b.toString();c=c.substring(c.indexOf("{")+1,c.lastIndexOf("}")).trim();throw Error("Assertion failed: "+c);}}else if(!b){if(f)throw Error(f);throw Error("Assertion failed: "+
String(b));}},h=function(){d(function(){return a.check.argsNotNull.apply(this,arguments)})},b=function(b){d(function(){return a.check.exists(b)})},c=function(b){d(function(){return a.check.isArray(b)})},e=function(b){d(function(){return a.check.isBoolean(b)})},f=function(b){d(function(){return a.check.isDate(b)})},k=function(b){d(function(){return a.check.isFunction(b)})},l=function(b){d(function(){return a.check.isNonEmptyArray(b)})},m=function(b){d(function(){return a.check.isNumber(b)})},n=function(b){d(function(){return a.check.isObject(b)})},
q=function(b){d(function(){return a.check.isReference(b)})},p=function(){var b=arguments;d(function(){return a.check.isSmashable.apply(g,b)})},r=function(b){d(function(){return a.check.isString(b)})},s=function(b,f){d(function(){return a.check.isType(b,f)})},t=function(b){d(function(){return a.check.isValue(b)})},u=function(){return function(){return function(d){a.defineProperty(d,"argsNotNull",{get:function(){return h},writeable:!1});a.defineProperty(d,"exists",{get:function(){return b},writeable:!1});
a.defineProperty(d,"isArray",{get:function(){return c},writeable:!1});a.defineProperty(d,"isBoolean",{get:function(){return e},writeable:!1});a.defineProperty(d,"isDate",{get:function(){return f},writeable:!1});a.defineProperty(d,"isFunction",{get:function(){return k},writeable:!1});a.defineProperty(d,"isNonEmptyArray",{get:function(){return l},writeable:!1});a.defineProperty(d,"isNumber",{get:function(){return m},writeable:!1});a.defineProperty(d,"isObject",{get:function(){return n},writeable:!1});
a.defineProperty(d,"isReference",{get:function(){return q},writeable:!1});a.defineProperty(d,"isSmashable",{get:function(){return p},writeable:!1});a.defineProperty(d,"isString",{get:function(){return r},writeable:!1});a.defineProperty(d,"isType",{get:function(){return s},writeable:!1});a.defineProperty(d,"isValue",{get:function(){return t},writeable:!1});return d}(d)}}();a.classes.Asserter=u;a.assert=new a.classes.Asserter})(zUtil.prototype);
(function(a,g){var d=function(){};d.argsNotNull=function(){for(var a=0;a<arguments.length;a++)if(null==arguments[a])return!1;return!0};d.exists=function(a){return null!=a};d.isArray=function(d){return a.getType(d)===a.types.array};d.isBoolean=function(d){return a.getType(d)===a.types.boolean};d.isDate=function(d){return a.getType(d)===a.types.date};d.isFunction=function(d){return a.getType(d)===a.types.function};d.isGeneratorFunction=function(d){return a.getType(d)===a.types.function&&d.isGenerator()};
d.isIterable=function(d){return null==d?!1:a.getType(d[a.symbols.iterator]||d.prototype[a.symbols.iterator])===a.types.function};d.isNonEmptyArray=function(d){return null!=d&&a.getType(d)===a.types.array&&0<d.length};d.isNumber=function(a){return!isNaN(a)};d.isObject=function(d){return a.getType(d)===a.types.object};d.isReference=function(d){switch(a.getType(d)){case a.types.array:case a.types.date:case a.types.function:case a.types.generator:case a.types.generatorFunction:case a.types.object:case a.types.regexp:return!0;
default:return!1}};d.isSmashable=function(){var d=Array.prototype.slice.call(arguments);if(1>d.length)return!1;var b=a.getType(d[0]);if(b!==a.types.array&&b!==a.types.object&&b!==a.types.function)return!1;b===a.types.function&&(b=a.types.object);for(var c=1;c<d.length;c++){var e=a.getType(d[c]);e===a.types.function&&(e=a.types.object);if(e!==b)return!1}return!0};d.isString=function(d){return a.getType(d)===a.types.string};d.isType=function(d,b){return a.getType(d)===b};d.isValue=function(d){switch(a.getType(d)){case a.types.boolean:case a.types.null:case a.types.number:case a.types.string:case a.types.undefined:return!0;
default:return!1}};a.check=d})(zUtil.prototype);
(function(a,g){a.classes=a.classes||{};var d=function(f,d){a.assert.isString(d);switch(d){case a.types.boolean:return h(f);case a.types.date:return b(f);case a.types.number:return c(f)}},h=function(b){if(a.check.exists(b)&&a.check.isFunction(b.toBoolean))return b.toBoolean();switch(a.getType(b)){case a.types.boolean:return b;case a.types.string:switch(b.toLowerCase().trim()){case "false":case "0":case "":case null:case g:return!1;default:return!0}default:return!!b}},b=function(b){if(a.check.exists(b)&&
a.check.isFunction(b.toDate))return b.toDate();switch(a.getType(b)){case a.types.date:return b;case a.types.string:return new Date(Date.parse(b));default:return new Date(Date.parse(b.toString()))}},c=function(b){if(a.check.exists(b)&&a.check.isFunction(b.toNumber))return b.toNumber();switch(a.getType(b)){case a.types.number:return b;default:return+b}},e=function(){return function(){return function(f){a.defineProperty(f,"toBoolean",{get:function(){return h},writeable:!1});a.defineProperty(f,"toDate",
{get:function(){return b},writeable:!1});a.defineProperty(f,"toNumber",{get:function(){return c},writeable:!1});return f}(d)}}();a.classes.Converter=e;a.convert=new a.classes.Converter})(zUtil.prototype);
(function(a,g){var d={},h;d.build=function(b){a.check.isObject(b);a.check.isArray(b.Tables);b=b.Tables.orderBy("x => x.TableName");for(var c=0;c<b.length;c++)d.makeTable(b[c])};d.makeTable=function(b){a.check.isObject(b);a.check.isString(b.TableName);a.check.isArray(b.PrimaryKeys);a.check.isArray(b.ForeignKeys);var c=[],e=[],f=[],g=[];switch(h){case "sqlite":c.push("CREATE TABLE IF NOT EXISTS "+b.TableName+" (");for(var l=0;l<b.Columns.length;l++){var m=b.Columns[l],n=d.types[m.DataType][h],n=n.length?
n.type+"("+n.length+")":n.type;0===l?e.push("    "+m.ColumnName+" "+n+(m.IsNullable?"":" NOT NULL")):e.push(m.ColumnName+" "+n+(m.IsNullable?"":" NOT NULL"))}e=e.join("\n    , ");c.push(e);g.push("    , PRIMARY KEY (");for(l=0;l<b.PrimaryKeys.length;l++)f.push(b.PrimaryKeys[l].ColumnName);g.push(f.join(", "));g.push(")");b=g.join("");c.push(b);c.push(")");c.join("\n")}};d.load=function(b,c,d){a.check.isString(b);a.check.isString(c);a.check.isNumber(d);h=c.toLowerCase();switch(h){case "sqlite":openDatabase(b,
"0.1",b,d)}};d.types={bit:{sqlite:{type:"INTEGER"}},"char":{sqlite:{type:"TEXT"}},datetime:{sqlite:{type:"TEXT"}},datetime2:{sqlite:{type:"TEXT"}},decimal:{sqlite:{type:"REAL"}},"float":{sqlite:{type:"REAL"}},"int":{sqlite:{type:"INTEGER"}},money:{sqlite:{type:"REAL"}},nvarchar:{sqlite:{type:"TEXT"}},smallint:{sqlite:{type:"INTEGER"}},smallmoney:{sqlite:{type:"REAL"}},text:{sqlite:{type:"TEXT"}},tinyint:{sqlite:{type:"INTEGER"}},varchar:{sqlite:{type:"TEXT"}},uniqueidentifier:{sqlite:{type:"CHAR",
length:36},mssql:{type:"uniqueidentifier"}}};a.db=d})(zUtil.prototype);
(function(a,g){a.classes=a.classes||{};var d=function(){return function(){var d=[],b=function(a){var b=d[a];if(null!=b)for(var c=0;c<b.length;c++){var e=b[c];null!=e.func&&e.func.apply(null,Array.prototype.slice.call(arguments,1))}},c=function(b){a.check.exists(b);d[b]=null},e=function(b,c){a.check.exists(b);a.check.isFunction(c);var e=d[b]||(d[b]=[]),g={func:c};e.push(g);return function(){d[b].removeAll(function(a){return a===g})}};return function(f){a.defineProperty(f,"call",{get:function(){return b},
writeable:!1});a.defineProperty(f,"clear",{get:function(){return c},writeable:!1});a.defineProperty(f,"on",{get:function(){return e},writeable:!1});return f}({})}}();a.classes.Events=d;a.events=new a.classes.Events})(zUtil.prototype);
(function(a,g){a.functions=a.functions||{};var d=function(){return a.deepCopy(this)},h=function(b,c){return a.defineProperty(this,b,c)},b=function(b){return a.equals(this,b)},c=function(){var b=Array.prototype.slice.call(arguments);b.unshift(this);return a.functions.extend.apply(null,b)};a.functions.extend=function(){return a.extend.apply(null,arguments)};a.functions.getArgumentNames=function(){var b=0,b=a.getType(this)===a.types.function?this:arguments[b++];a.assert.isFunction(b);b=b.toString();
b=b.substring(b.indexOf("(")+1,b.indexOf(")")).trim().split(",");b.map(function(a,b,c){c[b]=a.trim().replace(/(\n)?\/\*\*\//g,"")});return b};a.functions.getBody=function(){var b=0,b=a.getType(this)===a.types.function?this:arguments[b++];a.assert.isFunction(b);b=b.toString();return b.toString().substring(b.indexOf("{")+1,b.indexOf("}")).trim()};var e=function(){var b=Array.prototype.slice.call(arguments);b.unshift(this);return a.functions.smash.apply(null,b)};a.functions.smash=function(){return a.smash.apply(null,
arguments)};a.setup.initFunctions=function(f){f&&(a.defineProperty(Function.prototype,"deepCopy",{enumerable:!1,writable:!1,value:d}),a.defineProperty(Function.prototype,"defineProperty",{enumerable:!1,writable:!1,value:h}),a.defineProperty(Function.prototype,"equals",{enumerable:!1,writable:!1,value:b}),a.defineProperty(Function.prototype,"extend",{enumerable:!1,writable:!1,value:c}),a.defineProperty(Function.prototype,"getArgumentNames",{enumerable:!1,writable:!1,value:a.functions.getArgumentNames}),
a.defineProperty(Function.prototype,"getBody",{enumerable:!1,writable:!1,value:a.functions.getBody}),a.defineProperty(Function.prototype,"smash",{enumerable:!1,writable:!1,value:e}))}})(zUtil.prototype);
(function(a,g){var d=/\+/g,h=function(b){a.defineProperty(b,"parameters",{get:function(){var a={},b=window.location.href,f=b.indexOf("?");if(-1<f)for(b=b.substring(f+1).split("&"),f=0;f<b.length;f++){var g=b[f].split("=");2==g.length&&(a[g[0]]=decodeURIComponent(g[1].replace(d," ")))}return a},writeable:!1});a.defineProperty(b,"locale",{get:function(){return this.parameters.locale||navigator.language||navigator.userLanguage},writeable:!1});return b}({});a.location=h})(zUtil.prototype);
(function(a,g){a.classes=a.classes||{};var d=["log"],h=function(){return function(b,c){var e,f,h,l,m,n,q=function(b){if(a.getType(b)===a.types.string)a:switch(b.toLowerCase().trim()){case "false":case "0":case "":case null:case g:b=!1;break a;default:b=!0}e=!!b},p;(p=function(b){a.assert.exists(b);for(var e=0;e<d.length;e++)a.assert.isFunction(b[d[e]]);f=b.log.bind(b);h=a.check.exists(b.debug)?b.debug.bind(b):b.log.bind(b);l=a.check.exists(b.error)?b.error.bind(b):b.log.bind(b);m=a.check.exists(b.info)?
b.info.bind(b):b.log.bind(b);n=a.check.exists(b.warn)?b.warn.bind(b):b.log.bind(b);q(null!=c?c:a.location?a.location.parameters.debug:!1)})(b);return function(b){a.defineProperty(b,"debug",{get:function(){return e?h:a.functions.empty},writeable:!1});a.defineProperty(b,"error",{get:function(){return l},writeable:!1});a.defineProperty(b,"info",{get:function(){return m},writeable:!1});a.defineProperty(b,"log",{get:function(){return f},writeable:!1});a.defineProperty(b,"warn",{get:function(){return n},
writeable:!1});a.defineProperty(b,"setDebugLogging",{get:function(){return q},writeable:!1});a.defineProperty(b,"setLogger",{get:function(){return p},writeable:!1});return b}(f)}}();a.setup.initLogger=function(b){a.check.exists(b)&&(a.log=new a.classes.LogInterface(b))};a.classes.LogInterface=h})(zUtil.prototype);
(function(a,g){a.match=function(d,g){var b=[];if(!g||a.getType(g)!==a.types.object||!d||a.getType(d)!==a.types.array||1>d.length)return b;var c=Object.keys(g).length;if(1>c)return b;for(var e,f=0;f<d.length;f++){e=0;for(var k in g){var l;l=d[f][k];var m=g[k];if(a.getType(l)===a.types.array){a.getType(m)!==a.types.array&&(m=[m]);b:{for(var n=0;n<m.length;n++)if(!l.contains(m[n])){l=!1;break b}l=!0}}else l=l===m;l&&e++}e===c&&b.push(d[f])}return b}})(zUtil.prototype);
(function(a,g){a.numbers={};a.numbers.factors=function(){var d=0,d=a.getType(this)===a.types.number?this:arguments[d++];a.assert.isNumber(d);for(var g=[],b=[],c=1;c<=Math.floor(Math.sqrt(d));c++)0==d%c&&(g.push(c),d/c!==c&&b.push(d/c));return g.concat(b.reverse())};a.numbers.round=function(){var d=0,g=a.getType(this)===a.types.number?this:arguments[d++],b=arguments[d++]||1,d=arguments[d++];a.assert.isNumber(g);if(d){d=d.toString().toLowerCase();if("down"===d)return a.numbers.roundDown(g,b);if("up"===
d)return a.numbers.roundUp(g,b)}return Math.round(g/b)*b};a.numbers.roundDown=function(){var d=0,g=a.getType(this)===a.types.number?this:arguments[d++],d=arguments[d++]||1;a.assert.isNumber(g);return Math.floor(g/d)*d};a.numbers.roundUp=function(){var d=0,g=a.getType(this)===a.types.number?this:arguments[d++],d=arguments[d++]||1;a.assert.isNumber(g);return Math.ceil(g/d)*d};a.setup.initNumbers=function(d){d&&(a.defineProperty(Number.prototype,"factors",{enumerable:!1,writable:!1,value:a.numbers.factors}),
a.defineProperty(Number.prototype,"round",{enumerable:!1,writable:!1,value:a.numbers.round}),a.defineProperty(Number.prototype,"roundDown",{enumerable:!1,writable:!1,value:a.numbers.roundDown}),a.defineProperty(Number.prototype,"roundUp",{enumerable:!1,writable:!1,value:a.numbers.roundUp}))}})(zUtil.prototype);
(function(a,g){a.objects={};var d=function(){return a.deepCopy(this)},h=function(b,c){return a.defineProperty(this,b,c)},b=function(b){return a.equals(this,b)},c=function(){var b=Array.prototype.slice.call(arguments);b.unshift(this);return a.objects.extend.apply(null,b)};a.objects.extend=function(){return a.extend.apply(null,arguments)};var e=function(){var b=Array.prototype.slice.call(arguments);b.unshift(this);return a.objects.smash.apply(null,b)};a.objects.smash=function(){return a.smash.apply(null,
arguments)};a.setup.initObjects=function(f){f&&(a.defineProperty(Object.prototype,"deepCopy",{enumerable:!1,writable:!1,value:d}),a.defineProperty(Object.prototype,"defineProperty",{enumerable:!1,writable:!1,value:h}),a.defineProperty(Object.prototype,"equals",{enumerable:!1,writable:!1,value:b}),a.defineProperty(Object.prototype,"extend",{enumerable:!1,writable:!1,value:c}),a.defineProperty(Object.prototype,"smash",{enumerable:!1,writable:!1,value:e}))}})(zUtil.prototype);
(function(a,g){function d(b){var d=new h,f=b||"";this.stop=function(){d.stop();a.log.debug(f+" took: "+d.duration()+" ms")};d.start()}function h(){var a=null,b=null,d=!1;this.start=function(){d||(b=null,d=!0,a=(new Date).getTime())};this.stop=function(){d&&(b=(new Date).getTime(),d=!1)};this.duration=function(){return d?(new Date).getTime()-a:b-a};this.reset=function(){d=!1;b=a=null}}a.classes=a.classes||{};var b=function(){return function(){var b=[],e=function(a){b.push(new d(a))},f=function(){0<
b.length&&b.pop().stop()};return function(b){a.defineProperty(b,"push",{get:function(){return e},writeable:!1});a.defineProperty(b,"pop",{get:function(){return f},writeable:!1});return b}({})}}();a.classes.StopwatchStack=b;a.classes.StopwatchWrapper=d;a.classes.Stopwatch=h;a.sw=new a.classes.StopwatchStack})(zUtil.prototype);
